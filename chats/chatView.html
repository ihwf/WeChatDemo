<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
   		<link rel="stylesheet" href="../css/iconfont.css">
		<link href="../css/mui.imageviewer.css" rel="stylesheet" />
		<link href="../css/im-chat.css" rel="stylesheet" />
		<link href="../css/chatViewFont.css" rel="stylesheet" />
		<link href="../css/chatView.css" rel="stylesheet" />
		
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
	        <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
	        <h1 class="mui-title"></h1>
	        <a class="mui-icon iconfont mui-pull-right">&#xe60a;</a>
	    </header>
		
		<pre id='h'></pre>
		<script id='msg-template' type="text/template">
			<% for(var i in record){ var item=record[i]; %>
				<div class="msg-item <%= (item.sender=='self'?' msg-item-self':'') %>" msg-type='<%=(item.type)%>' msg-content='<%=(item.content)%>'>
					<% if(item.sender=='self' ) { %>
						<i class="msg-user mui-icon mui-icon-person"></i>
					<% } else { %>
						<img class="msg-user-img" src="" alt="" />
					<% } %>
					<div class="msg-content">
						<div class="msg-content-inner">
							<% if(item.type=='text' ) { %>
								<%=( item.content|| '&nbsp;&nbsp;') %>
							<% } else if(item.type=='image' ) { %>
								<img class="msg-content-image" src="<%=(item.content)%>" style="max-width: 100px;" />
							<% } else if(item.type=='sound' ) { %>
								<span class="mui-icon mui-icon-mic" style="font-size: 18px;font-weight: bold;"></span>
								<span class="play-state">点击播放</span>
							<% } %>
						</div>
						<div class="msg-content-arrow"></div>
					</div>
					<div class="mui-item-clear"></div>
				</div>
			<% } %>
		</script>
		<div class="mui-content">
			<div id='msg-list'>
			</div>
		</div>
		<footer>
			<div class="footer-left">
				<i id='msg-image' class="mui-icon iconfont yuyin"></i>
			</div>
			<div class="footer-center">
				<textarea id='msg-text' type="text" class='input-text'></textarea>
				<button id='msg-sound' type="button" class='input-sound' style="display: none;">按住说话</button>
			</div>
			<label for="" class="footer-right">
				<i id="biaoqing" class="iconfont icon-biaoqing"></i>
				<i id='msg-type' class="mui-icon mui-icon-plus"></i>
			</label>
		</footer>
		
		
		<!--九宫格-->
		<div id="Gallery" class="mui-slider">
				<div class="mui-slider-group">
					<div class="mui-slider-item">
						<ul class="mui-table-view mui-grid-view mui-grid-9">
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<a href="#" class="takePhoto">
									<span class="mui-icon iconfont icon-xiangce-copy"></span>
									<div class="mui-media-body">图片</div>
								</a>
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<a href="#">
									<span class="mui-icon iconfont yanjing"></span>
									<div class="mui-media-body">小视频</div>
								</a>
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<a href="#">
									<span class="mui-icon iconfont hongbao"></span>
									<div class="mui-media-body">红包</div>
								</a>
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<a href="#">
									<span class="mui-icon iconfont weixinzhanghuzhuye226"></span>
									<div class="mui-media-body">转账</div>
								</a>
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<a href="#">
									<span class="mui-icon iconfont icon-dongtaiyemianxiaotubiao03"></span>
									<div class="mui-media-body">我的收藏</div>
								</a>
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<a href="#">
									<span class="mui-icon mui-icon-location"></span>
									<div class="mui-media-body">位置</div>
								</a>
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<a href="#">
									<span class="mui-icon iconfont video"></span>
									<div class="mui-media-body">视频聊天</div>
								</a>
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<a href="#">
									<span class="mui-icon iconfont icon-wo"></span>
									<div class="mui-media-body">名片</div>
								</a>
							</li>
							
						</ul>
					</div>
					<div class="mui-slider-item">
						<ul class="mui-table-view mui-grid-view mui-grid-9">
							<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3">
								<a href="#">
									<span class="mui-icon mui-icon-mic"></span>
									<div class="mui-media-body">语音输入</div>
								</a>
							</li>
						</ul>
					</div>

				</div>
				<div class="mui-slider-indicator">
					<div class="mui-indicator mui-active"></div>
					<div class="mui-indicator"></div>
				</div>
			</div>
		
		<!--表情包-->
		<div id="biaoqingbao" class="mui-slider">
				<div class="mui-slider-group">
					<div class="mui-slider-item">
						<ul class="mui-table-view mui-grid-view mui-grid-9">
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/1.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/2.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/3.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/4.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/5.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/6.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/7.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/8.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/9.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/10.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/11.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/12.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/13.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/14.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/15.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/16.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/17.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/18.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/19.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/20.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/21.gif" alt="" />
							</li>
							
						</ul>
					</div>
					<div class="mui-slider-item">
						<ul class="mui-table-view mui-grid-view mui-grid-9">
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/22.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/23.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/24.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/25.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/26.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/27.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/28.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/29.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/30.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/31.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/32.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/33.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/34.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/35.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/36.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/37.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/38.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/39.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/40.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/41.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/42.gif" alt="" />
							</li>
							
						</ul>
					</div>
					<div class="mui-slider-item">
						<ul class="mui-table-view mui-grid-view mui-grid-9">
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/43.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/44.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/45.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/46.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/47.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/48.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/49.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/50.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/51.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/52.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/53.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/54.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/55.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/56.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/57.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/58.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/59.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/60.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/61.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/62.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/63.gif" alt="" />
							</li>
							
						</ul>
					</div>
					<div class="mui-slider-item">
						<ul class="mui-table-view mui-grid-view mui-grid-9">
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/64.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/65.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/66.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/67.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/68.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/69.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/70.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/71.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/72.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/73.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/74.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/75.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/76.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/77.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/78.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/79.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/80.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/81.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/82.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/83.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/84.gif" alt="" />
							</li>
							
						</ul>
					</div>
					<div class="mui-slider-item">
						<ul class="mui-table-view mui-grid-view mui-grid-9">
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/85.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/86.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/87.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/88.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/89.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/90.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/91.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/92.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/93.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/94.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/95.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/96.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/97.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/98.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/99.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/100.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/103.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/104.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/106.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/108.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/109.gif" alt="" />
							</li>
						</ul>
					</div>
					<div class="mui-slider-item">
						<ul class="mui-table-view mui-grid-view mui-grid-9">
							
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/110.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/111.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/112.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/113.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/114.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/115.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/116.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/117.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/118.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/119.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/120.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/121.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/122.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/123.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/124.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/125.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/126.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/127.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/128.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/129.gif" alt="" />
							</li>
							<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-2">
								<img src="../images/QQExpression/132.gif" alt="" />
							</li>
						</ul>
					</div>

				</div>
				<div class="mui-slider-indicator">
					<div class="mui-indicator mui-active"></div>
					<div class="mui-indicator"></div>
					<div class="mui-indicator"></div>
					<div class="mui-indicator"></div>
					<div class="mui-indicator"></div>
					<div class="mui-indicator"></div>
<<<<<<< HEAD
					<div class="mui-indicator"></div>
=======
>>>>>>> master
				</div>
			</div>
		
		<div id='sound-alert' class="rprogress">
			<div class="rschedule"></div>
			<div class="r-sigh">!</div>
			<div id="audio_tips" class="rsalert">手指上滑，取消发送</div>
		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/mui.imageViewer.js"></script>
		<script src="../js/arttmpl.js"></script>
		<script type="text/javascript" charset="utf-8">
			(function($, doc) {
				var MIN_SOUND_TIME = 800;
				$.init({
					gestureConfig: {
						tap: true, //默认为true
						doubletap: true, //默认为false
						longtap: true, //默认为false
						swipe: true, //默认为true
						drag: true, //默认为true
						hold: true, //默认为false，不监听
						release: true //默认为false，不监听
					}
				});
				template.config('escape', false);
				//$.plusReady=function(fn){fn();};
				$.plusReady(function() {
					plus.webview.currentWebview().setStyle({
						softinputMode: "adjustResize"
					});
					var showKeyboard = function() {
						if ($.os.ios) {
							var webView = plus.webview.currentWebview().nativeInstanceObject();
							webView.plusCallMethod({
								"setKeyboardDisplayRequiresUserAction": false
							});
						} else {
							var Context = plus.android.importClass("android.content.Context");
							var InputMethodManager = plus.android.importClass("android.view.inputmethod.InputMethodManager");
							var main = plus.android.runtimeMainActivity();
							var imm = main.getSystemService(Context.INPUT_METHOD_SERVICE);
							imm.toggleSoftInput(0, InputMethodManager.SHOW_FORCED);
							//var view = ((ViewGroup)main.findViewById(android.R.id.content)).getChildAt(0);
							imm.showSoftInput(main.getWindow().getDecorView(), InputMethodManager.SHOW_IMPLICIT);
							//alert("ll");
						}
					};
					var record = [{
						sender: 'zs',
						type: 'text',
						content: 'Hi，你是谁?'
					}];
					var ui = {
						body: doc.querySelector('body'),
						footer: doc.querySelector('footer'),
						footerRight: doc.querySelector('.footer-left'),
						footerLeft: doc.querySelector('.footer-right'),
						btnMsgImage: doc.querySelector('#msg-type'),
						boxMsgText: doc.querySelector('#msg-text'),
						boxMsgSound: doc.querySelector('#msg-sound'),
						btnMsgType: doc.querySelector('#msg-image'),
						areaMsgList: doc.querySelector('#msg-list'),
						boxSoundAlert: doc.querySelector('#sound-alert'),
						h: doc.querySelector('#h'),
						content: doc.querySelector('.mui-content')
					};
					ui.h.style.width = ui.boxMsgText.offsetWidth + 'px';
					//alert(ui.boxMsgText.offsetWidth );
					var footerPadding = ui.footer.offsetHeight - ui.boxMsgText.offsetHeight;
					var msgItemTap = function(msgItem, event) {
						var msgType = msgItem.getAttribute('msg-type');
						var msgContent = msgItem.getAttribute('msg-content')
						if (msgType == 'sound') {
							player = plus.audio.createPlayer(msgContent);
							var playState = msgItem.querySelector('.play-state');
							playState.innerText = '正在播放...';
							player.play(function() {
								playState.innerText = '点击播放';
							}, function(e) {
								playState.innerText = '点击播放';
							});
						}
					};
					var imageViewer = new $.ImageViewer('.msg-content-image', {
						dbl: false
					});
					var bindMsgList = function() {
						//绑定数据:
						/*tp.bind({
							template: 'msg-template',
							element: 'msg-list',
							model: record
						});*/
						ui.areaMsgList.innerHTML = template('msg-template', {
							"record": record
						});
						var msgItems = ui.areaMsgList.querySelectorAll('.msg-item');
						[].forEach.call(msgItems, function(item, index) {
							item.addEventListener('tap', function(event) {
								msgItemTap(item, event);
							}, false);
						});
						imageViewer.findAllImage();
						ui.areaMsgList.scrollTop = ui.areaMsgList.scrollHeight + ui.areaMsgList.offsetHeight;
					};
					bindMsgList();
					window.addEventListener('resize', function() {
						ui.areaMsgList.scrollTop = ui.areaMsgList.scrollHeight + ui.areaMsgList.offsetHeight;
					}, false);
					var send = function(msg) {
						record.push(msg);
						bindMsgList();
						toRobot(msg.content);
					};
					var toRobot = function(info) {
						var apiUrl = 'http://www.tuling123.com/openapi/api';
						$.getJSON(apiUrl, {
							"key": 'acfbca724ea1b5db96d2eef88ce677dc',
							"info": info,
							"userid": plus.device.uuid
						}, function(data) {
							//alert(JSON.stringify(data));
							record.push({
								sender: 'zs',
								type: 'text',
								content: data.text
							});
							bindMsgList();
						});
					};

					//选择表情
					mui('#biaoqingbao').on('tag','img',function() {
						var faceImg = this.getAttribute('src');
						alert(faceImg);
					});
<<<<<<< HEAD
//					var cmr = plus.camera.getCamera();
//									cmr.captureImage(function(path) {
//										send({
//											sender: 'self',
//											type: 'image',
//											content: "file://" + plus.io.convertLocalFileSystemURL(path)
//										});
=======
//					var cmr = plus.camera.getCamera();
//									cmr.captureImage(function(path) {
//										send({
//											sender: 'self',
//											type: 'image',
//											content: "file://" + plus.io.convertLocalFileSystemURL(path)
//										});
>>>>>>> master
//									}, function(err) {});

					function msgTextFocus() {
							ui.boxMsgText.focus();
							setTimeout(function() {
								ui.boxMsgText.focus();
							}, 150);
						}
						//解决长按“发送”按钮，导致键盘关闭的问题；
					ui.footerLeft.addEventListener('touchstart', function(event) {
						if (ui.btnMsgImage.classList.contains('mui-icon-paperplane')) {
							msgTextFocus();
							event.preventDefault();
						}
					});
					//解决长按“发送”按钮，导致键盘关闭的问题；
					ui.footerLeft.addEventListener('touchmove', function(event) {
						if (ui.btnMsgImage.classList.contains('mui-icon-paperplane')) {
							msgTextFocus();
							event.preventDefault();
						}
					});
					//					ui.footerRight.addEventListener('touchcancel', function(event) {
					//						if (ui.btnMsgType.classList.contains('mui-icon-paperplane')) {
					//							msgTextFocus();
					//							event.preventDefault();
					//						}
					//					});
					//					ui.footerRight.addEventListener('touchend', function(event) {
					//						if (ui.btnMsgType.classList.contains('mui-icon-paperplane')) {
					//							msgTextFocus();
					//							event.preventDefault();
					//						}
					//					});
					//发送文字
					ui.footerLeft.addEventListener('release', function(event) {
						if (ui.btnMsgImage.classList.contains('mui-icon-paperplane')) {
						
//							showKeyboard();
							ui.boxMsgText.focus();
							setTimeout(function() {
								ui.boxMsgText.focus();
								document.querySelector('#Gallery').style.display = 'none';
<<<<<<< HEAD
								document.querySelector('#biaoqingbao').style.display = 'none';
								document.querySelector('footer').style.bottom = '0px';
=======
								document.querySelector('#biaoqingbao').style.display = 'none';
								document.querySelector('footer').style.bottom = '0px';
>>>>>>> master
							}, 150);
							//							event.detail.gesture.preventDefault();
							
							send({
								sender: 'self',
								type: 'text',
								content: ui.boxMsgText.value.replace(new RegExp('\n', 'gm'), '<br/>')
							});
							ui.boxMsgText.value = '';
							$.trigger(ui.boxMsgText, 'input', null);
						}
					} , false);
					//显示按住说话框
					ui.footerRight.addEventListener('release', function(event) {
						if (ui.btnMsgType.classList.contains('yuyin')) {
							ui.btnMsgType.classList.add('jianpan');
							ui.btnMsgType.classList.remove('yuyin');
							ui.boxMsgText.style.display = 'none';
							ui.boxMsgSound.style.display = 'block';
							
<<<<<<< HEAD
=======
							document.querySelector('#biaoqing').classList.add('icon-biaoqing');
							document.querySelector('#biaoqing').classList.remove('jianpan');
>>>>>>> master
							document.querySelector('#biaoqingbao').style.display = 'none';
							document.querySelector('#Gallery').style.display = 'none';
							document.querySelector('footer').style.bottom = '0px';
							
							ui.boxMsgText.blur();
							document.body.focus();
						} else if (ui.btnMsgType.classList.contains('jianpan')) {
							ui.btnMsgType.classList.add('yuyin');
							ui.btnMsgType.classList.remove('jianpan');
							ui.boxMsgSound.style.display = 'none';
							ui.boxMsgText.style.display = 'block';
							
<<<<<<< HEAD
=======
							
>>>>>>> master
							document.querySelector('#biaoqingbao').style.display = 'none';
							document.querySelector('#Gallery').style.display = 'none';
							document.querySelector('footer').style.bottom = '0px';
							//--
							//showKeyboard();
							ui.boxMsgText.focus();
							setTimeout(function() {
								ui.boxMsgText.focus();
							}, 150);
						}
					}, false);
					
					//相机功能 takePhoto
					document.querySelector('.takePhoto').addEventListener('tap', function(event) {
						var btnArray = [{
							title: "拍照"
						}, {
							title: "从相册选择"
						}];
						plus.nativeUI.actionSheet({
							title: "选择照片",
							cancel: "取消",
							buttons: btnArray
						}, function(e) {
							var index = e.index;
							switch (index) {
								case 0:
									break;
								case 1:
									var cmr = plus.camera.getCamera();
									cmr.captureImage(function(path) {
										send({
											sender: 'self',
											type: 'image',
											content: "file://" + plus.io.convertLocalFileSystemURL(path)
										});
									}, function(err) {});
									break;
								case 2:
									plus.gallery.pick(function(path) {
										send({
											sender: 'self',
											type: 'image',
											content: path
										});
									}, function(err) {}, null);
									break;
							}
						});
					}, false); 


					var setSoundAlertVisable=function(show){
						if(show){
							ui.boxSoundAlert.style.display = 'block';
							ui.boxSoundAlert.style.opacity = 1;
						}else{
							ui.boxSoundAlert.style.opacity = 0;
							//fadeOut 完成再真正隐藏
							setTimeout(function(){
								ui.boxSoundAlert.style.display = 'none';
							},200);
						}
					};
					var recordCancel = false;
					var recorder = null;
					var audio_tips = document.getElementById("audio_tips");
					var startTimestamp = null;
					var stopTimestamp = null;
					var stopTimer = null;
					ui.boxMsgSound.addEventListener('hold', function(event) {
						recordCancel = false;
						if(stopTimer)clearTimeout(stopTimer);
						audio_tips.innerHTML = "手指上划，取消发送";
						ui.boxSoundAlert.classList.remove('rprogress-sigh');
						setSoundAlertVisable(true);
						recorder = plus.audio.getRecorder();
						if (recorder == null) {
							plus.nativeUI.toast("不能获取录音对象");
							return;
						}
						startTimestamp = (new Date()).getTime();
						recorder.record({
							filename: "_doc/audio/"
						}, function(path) {
							if (recordCancel) return;
							send({
								sender: 'self',
								type: 'sound',
								content: path
							});
						}, function(e) {
							plus.nativeUI.toast("录音时出现异常: " + e.message);
						});
					}, false);
					ui.body.addEventListener('drag', function(event) {
						//console.log('drag');
						if (Math.abs(event.detail.deltaY) > 50) {
							if (!recordCancel) {
								recordCancel = true;
								if (!audio_tips.classList.contains("cancel")) {
									audio_tips.classList.add("cancel");
								}
								audio_tips.innerHTML = "松开手指，取消发送";
							}
						} else {
							if (recordCancel) {
								recordCancel = false;
								if (audio_tips.classList.contains("cancel")) {
									audio_tips.classList.remove("cancel");
								}
								audio_tips.innerHTML = "手指上划，取消发送";
							}
						}
					}, false);
					ui.boxMsgSound.addEventListener('release', function(event) {
						//console.log('release');
						if (audio_tips.classList.contains("cancel")) {
							audio_tips.classList.remove("cancel");
							audio_tips.innerHTML = "手指上划，取消发送";
						}
						//
						stopTimestamp = (new Date()).getTime();
						if (stopTimestamp - startTimestamp < MIN_SOUND_TIME) {
							audio_tips.innerHTML = "录音时间太短";
							ui.boxSoundAlert.classList.add('rprogress-sigh');
							recordCancel = true;
							stopTimer=setTimeout(function(){
								setSoundAlertVisable(false);
							},800);
						}else{
							setSoundAlertVisable(false);
						}
						recorder.stop();
					}, false);
					ui.boxMsgSound.addEventListener("touchstart", function(e) {
						//console.log("start....");
						e.preventDefault();
					});
					//显示发送按钮
					ui.boxMsgText.addEventListener('input', function(event) {
						ui.btnMsgImage.classList[ui.boxMsgText.value == '' ? 'remove' : 'add']('mui-icon-paperplane');
						
						
						ui.btnMsgImage.setAttribute("for", ui.boxMsgText.value == '' ? '' : 'msg-text');
						ui.h.innerText = ui.boxMsgText.value.replace(new RegExp('\n', 'gm'), '\n-') || '-';
						ui.footer.style.height = (ui.h.offsetHeight + footerPadding) + 'px';
						ui.content.style.paddingBottom = ui.footer.style.height;
					});
					
					//显示键盘
					var focus = false;
					ui.boxMsgText.addEventListener('tap', function(event) {
						document.querySelector('#biaoqingbao').style.display = 'none';
						document.querySelector('#Gallery').style.display = 'none';
						document.querySelector('footer').style.bottom = '0px';
						
						document.querySelector('#biaoqing').classList.add('icon-biaoqing');
						document.querySelector('#biaoqing').classList.remove('jianpan');
						
						ui.boxMsgText.focus();
						setTimeout(function() {
							ui.boxMsgText.focus();
						}, 0);
						focus = true;
						setTimeout(function () {
							focus = false;
						},1000);
						event.detail.gesture.preventDefault();
					}, false);
					//点击消息列表，关闭键盘
					ui.areaMsgList.addEventListener('click',function (event) {
						if(!focus){
							ui.boxMsgText.blur();
						}
					})
					//显示更多
					document.querySelector('.mui-icon-plus').addEventListener('tap',function(){
					if(document.querySelector('#Gallery').style.display == 'none'){
						document.querySelector('footer').style.bottom = '237px';
						document.querySelector('#biaoqingbao').style.display = 'none';
						document.querySelector('#Gallery').style.display = 'block';
						ui.boxMsgText.blur();
					}else{
						document.querySelector('footer').style.bottom = '0px';
						document.querySelector('#Gallery').style.display = 'none';
						document.querySelector('#biaoqingbao').style.display = 'none';
						ui.boxMsgText.blur();
					}
					});
					//显示表情
					document.querySelector('#biaoqing').addEventListener('release', function(event) {
						if (this.classList.contains('icon-biaoqing')) {
							this.classList.add('jianpan');
							this.classList.remove('icon-biaoqing');
<<<<<<< HEAD
							
=======
>>>>>>> master
							document.querySelector('footer').style.bottom = '27%';
							document.querySelector('#biaoqingbao').style.display = 'block';
							document.querySelector('#Gallery').style.display = 'none';
							
							ui.boxMsgText.style.display = 'block';
							ui.boxMsgSound.style.display = 'none';
							
							ui.btnMsgType.classList.add('yuyin');
							ui.btnMsgType.classList.remove('jianpan');
							ui.boxMsgText.blur();
							document.body.focus();
						} else if (this.classList.contains('jianpan')) {
							this.classList.add('icon-biaoqing');
							this.classList.remove('jianpan');
							
							ui.boxMsgText.style.display = 'block';
							ui.boxMsgSound.style.display = 'none';
							
							document.querySelector('#biaoqingbao').style.display = 'none';
							document.querySelector('#Gallery').style.display = 'none';
							document.querySelector('footer').style.bottom = '0px';
							//--
							//showKeyboard();
							ui.boxMsgText.focus();
							setTimeout(function() {
								ui.boxMsgText.focus();
							}, 150);
						}
					}, false);
					
				});
			}(mui, document));
			
			
			mui.init()
			mui.plusReady(function() {
				var self = plus.webview.currentWebview();
				document.querySelector('.mui-title').innerText=self.chatTitle;
				document.querySelector('.msg-user-img').setAttribute('src','../'+self.chatHeader);
				
			});
		</script>
	</body>

</html>
